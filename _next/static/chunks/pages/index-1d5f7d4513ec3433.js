(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[405],{48312:function(e,t,r){(window.__NEXT_P=window.__NEXT_P||[]).push(["/",function(){return r(83327)}])},83327:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return eu}});var a,s,l=r(85893),o=r(67294);(a=s||(s={})).GPT_3_5="gpt-3.5-turbo",a.GPT_4="gpt-4";let n={[s.GPT_3_5]:{id:s.GPT_3_5,name:"Default (GPT-3.5)"},[s.GPT_4]:{id:s.GPT_4,name:"GPT-4"}};var i=r(94568),d=r(23461);let c=e=>{var t;let{onSend:r,messageIsStreaming:a,model:n,stopConversationRef:c,textareaRef:x}=e,[m,u]=(0,o.useState)(),[p,g]=(0,o.useState)(!1),h=e=>{let t=e.target.value,r=n.id===s.GPT_3_5?12e3:24e3;if(t.length>r){alert("Message limit is ".concat(r," characters"));return}u(t)},f=()=>{if(!a){if(!m){alert("Please enter a message");return}r({role:"user",content:m}),u(""),window.innerWidth<640&&x&&x.current&&x.current.blur()}},v=()=>{let e=void 0===window.navigator?"":navigator.userAgent;return/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini|Mobile|mobile|CriOS/i.test(e)},b=e=>{p||"Enter"!==e.key||e.shiftKey||v()||(e.preventDefault(),f())};return(0,o.useEffect)(()=>{if(x&&x.current){var e,t;x.current.style.height="inherit",x.current.style.height="".concat(null===(e=x.current)||void 0===e?void 0:e.scrollHeight,"px"),x.current.style.overflow="".concat((null==x?void 0:null===(t=x.current)||void 0===t?void 0:t.scrollHeight)>400?"auto":"hidden")}},[m]),(0,l.jsxs)("div",{className:"absolute bottom-0 left-0 w-full dark:border-white/20 border-transparent dark:bg-[#444654] dark:bg-gradient-to-t from-[#343541] via-[#343541] to-[#343541]/0 bg-white dark:!bg-transparent dark:bg-vert-dark-gradient pt-6 md:pt-2",children:[(0,l.jsxs)("div",{className:"stretch mx-2 md:mt-[52px] mt-4 flex flex-row gap-3 last:mb-2 md:mx-4 md:last:mb-6 lg:mx-auto lg:max-w-3xl",children:[a&&(0,l.jsxs)("button",{className:"absolute -top-2 md:top-0 left-0 right-0 mx-auto dark:bg-[#343541] border w-fit border-gray-500 py-2 px-4 rounded text-black dark:text-white hover:opacity-50",onClick:function(){c.current=!0,setTimeout(()=>{c.current=!1},1e3)},children:[(0,l.jsx)(i.Z,{size:16,className:"inline-block mb-[2px]"})," ","Stop Generating"]}),(0,l.jsxs)("div",{className:"flex flex-col w-full py-2 flex-grow md:py-3 md:pl-4 relative border border-black/10 bg-white dark:border-gray-900/50 dark:text-white dark:bg-[#40414F] rounded-md shadow-[0_0_10px_rgba(0,0,0,0.10)] dark:shadow-[0_0_15px_rgba(0,0,0,0.10)]",children:[(0,l.jsx)("textarea",{ref:x,className:"text-black dark:text-white m-0 w-full resize-none outline-none border-0 bg-transparent p-0 pr-7 focus:ring-0 focus-visible:ring-0 dark:bg-transparent pl-2 md:pl-0",style:{resize:"none",bottom:"".concat(null==x?void 0:null===(t=x.current)||void 0===t?void 0:t.scrollHeight,"px"),maxHeight:"400px",overflow:"".concat(x.current&&x.current.scrollHeight>400?"auto":"hidden")},placeholder:"Type a message...",value:m,rows:1,onCompositionStart:()=>g(!0),onCompositionEnd:()=>g(!1),onChange:h,onKeyDown:b}),(0,l.jsx)("button",{className:"absolute right-5 focus:outline-none text-neutral-800 hover:text-neutral-900 dark:text-neutral-100 dark:hover:text-neutral-200 dark:bg-opacity-50 hover:bg-neutral-200 p-1 rounded-sm",onClick:f,children:(0,l.jsx)(d.Z,{size:16,className:"opacity-60"})})]})]}),(0,l.jsxs)("div",{className:"px-3 pt-2 pb-3 text-center text-xs text-black/50 dark:text-white/50 md:px-4 md:pt-3 md:pb-6",children:[(0,l.jsx)("a",{href:"https://github.com/mckaywrigley/chatbot-ui",target:"_blank",rel:"noreferrer",className:"underline",children:"ChatBot UI"}),". Chatbot UI is an advanced chatbot kit for OpenAI's chat models aiming to mimic ChatGPT's interface and functionality."]})]})};var x=r(10614);let m=()=>(0,l.jsx)("div",{className:"group text-gray-800 dark:text-gray-100 border-b border-black/10 dark:border-gray-900/50 bg-gray-50 dark:bg-[#444654]",style:{overflowWrap:"anywhere"},children:(0,l.jsxs)("div",{className:"text-base gap-4 md:gap-6 md:max-w-2xl lg:max-w-2xl xl:max-w-3xl p-4 md:py-6 flex lg:px-0 m-auto",children:[(0,l.jsx)("div",{className:"font-bold min-w-[40px]",children:"AI:"}),(0,l.jsx)(x.Z,{className:"animate-pulse"})]})});var u=r(89313),p=r(72490);let g={javascript:".js",python:".py",java:".java",c:".c",cpp:".cpp","c++":".cpp","c#":".cs",ruby:".rb",php:".php",swift:".swift","objective-c":".m",kotlin:".kt",typescript:".ts",go:".go",perl:".pl",rust:".rs",scala:".scala",haskell:".hs",lua:".lua",shell:".sh",sql:".sql",html:".html",css:".css"},h=function(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r="ABCDEFGHJKLMNPQRSTUVWXY3456789",a="";for(let t=0;t<e;t++)a+=r.charAt(Math.floor(Math.random()*r.length));return t?a.toLowerCase():a};var f=r(80335),v=r(98683),b=r(84283);let w=e=>{let{language:t,value:r,lightMode:a}=e,[s,n]=(0,o.useState)("Copy code"),i=()=>{navigator.clipboard&&navigator.clipboard.writeText&&navigator.clipboard.writeText(r).then(()=>{n("Copied!"),setTimeout(()=>{n("Copy code")},2e3)})},d=()=>{let e=g[t]||".file",a="file-".concat(h(3,!0)).concat(e),s=window.prompt("Enter file name",a);if(!s)return;let l=new Blob([r],{type:"text/plain"}),o=URL.createObjectURL(l),n=document.createElement("a");n.download=s,n.href=o,n.style.display="none",document.body.appendChild(n),n.click(),document.body.removeChild(n),URL.revokeObjectURL(o)};return(0,l.jsxs)("div",{className:"relative text-[16px]",children:[(0,l.jsxs)("div",{className:"flex items-center justify-between",children:[(0,l.jsx)("span",{className:"text-xs text-white",children:t}),(0,l.jsxs)("div",{className:"flex items-center",children:[(0,l.jsx)("button",{className:"text-white bg-none py-0.5 px-2 rounded focus:outline-none hover:bg-blue-700 text-xs",onClick:i,children:s}),(0,l.jsx)("button",{className:"text-white bg-none py-0.5 px-2 rounded focus:outline-none hover:bg-blue-700 text-xs",onClick:d,children:(0,l.jsx)(f.Z,{size:16})})]})]}),(0,l.jsx)(v.Z,{language:t,style:"light"===a?b.Yn:b.vk,children:r})]})},j=e=>{let{message:t,lightMode:r}=e;return(0,l.jsx)("div",{className:"group ".concat("assistant"===t.role?"text-gray-800 dark:text-gray-100 border-b border-black/10 dark:border-gray-900/50 bg-gray-50 dark:bg-[#444654]":"text-gray-800 dark:text-gray-100 border-b border-black/10 dark:border-gray-900/50 bg-white dark:bg-[#343541]"),style:{overflowWrap:"anywhere"},children:(0,l.jsxs)("div",{className:"text-base gap-4 md:gap-6 md:max-w-2xl lg:max-w-2xl xl:max-w-3xl p-4 md:py-6 flex lg:px-0 m-auto",children:[(0,l.jsx)("div",{className:"font-bold min-w-[40px]",children:"assistant"===t.role?"AI:":"You:"}),(0,l.jsx)("div",{className:"prose dark:prose-invert mt-[-2px]",children:"user"===t.role?(0,l.jsx)("div",{className:"prose dark:prose-invert whitespace-pre-wrap",children:t.content}):(0,l.jsx)(u.D,{remarkPlugins:[p.Z],components:{code(e){let{node:t,inline:a,className:s,children:o,...n}=e,i=/language-(\w+)/.exec(s||"");return!a&&i?(0,l.jsx)(w,{language:i[1],value:String(o).replace(/\n$/,""),lightMode:r,...n},Math.random()):(0,l.jsx)("code",{className:s,...n,children:o})},table(e){let{children:t}=e;return(0,l.jsx)("table",{className:"border-collapse border border-black dark:border-white py-1 px-3",children:t})},th(e){let{children:t}=e;return(0,l.jsx)("th",{className:"border border-black dark:border-white break-words py-1 px-3 bg-gray-500 text-white",children:t})},td(e){let{children:t}=e;return(0,l.jsx)("td",{className:"border border-black dark:border-white break-words py-1 px-3",children:t})}},children:t.content})})]})})},y=e=>{let{model:t,models:r,onModelChange:a}=e;return(0,l.jsxs)("div",{className:"flex flex-col",children:[(0,l.jsx)("label",{className:"text-left mb-2 dark:text-neutral-400 text-neutral-700",children:"Model"}),(0,l.jsx)("select",{className:"w-full p-3 dark:text-white dark:bg-[#343541] border border-neutral-500 rounded-lg appearance-none focus:shadow-outline text-neutral-900 cursor-pointer",placeholder:"Select a model",value:t.id,onChange:e=>{a(r.find(t=>t.id===e.target.value))},children:r.map(e=>(0,l.jsx)("option",{value:e.id,children:e.name},e.id))})]})};var k=r(24888);let N=e=>{let{onRegenerate:t}=e;return(0,l.jsxs)("div",{className:"fixed sm:absolute bottom-4 sm:bottom-8 w-full sm:w-1/2 px-2 left-0 sm:left-[280px] lg:left-[200px] right-0 ml-auto mr-auto",children:[(0,l.jsx)("div",{className:"text-center mb-4 text-red-500",children:"Sorry, there was an error."}),(0,l.jsxs)("button",{className:"flex items-center justify-center w-full h-12 bg-neutral-100 dark:bg-[#444654] text-neutral-500 dark:text-neutral-200 text-sm font-semibold rounded-lg border border-b-neutral-300 dark:border-none",onClick:t,children:[(0,l.jsx)(k.Z,{className:"mr-2"}),(0,l.jsx)("div",{children:"Regenerate response"})]})]})},C="You are ChatGPT, a large language model trained by OpenAI. Follow the user's instructions carefully. Respond using markdown.",S=e=>{var t;let{conversation:r,onChangePrompt:a}=e,[s,n]=(0,o.useState)(""),i=(0,o.useRef)(null),d=e=>{let t=e.target.value;if(t.length>4e3){alert("Prompt limit is ".concat(4e3," characters"));return}n(t),t.length>0&&a(t)};return(0,o.useEffect)(()=>{if(i&&i.current){var e;i.current.style.height="inherit",i.current.style.height="".concat(null===(e=i.current)||void 0===e?void 0:e.scrollHeight,"px")}},[s]),(0,o.useEffect)(()=>{r.prompt?n(r.prompt):n(C)},[r]),(0,l.jsxs)("div",{className:"flex flex-col",children:[(0,l.jsx)("label",{className:"text-left dark:text-neutral-400 text-neutral-700 mb-2",children:"System Prompt"}),(0,l.jsx)("textarea",{ref:i,className:"w-full rounded-lg px-4 py-2 focus:outline-none dark:bg-[#40414F] dark:border-opacity-50 dark:border-neutral-800 dark:text-neutral-100 border border-neutral-500 shadow text-neutral-900",style:{resize:"none",bottom:"".concat(null==i?void 0:null===(t=i.current)||void 0===t?void 0:t.scrollHeight,"px"),maxHeight:"300px",overflow:"".concat(i.current&&i.current.scrollHeight>400?"auto":"hidden")},placeholder:"Enter a prompt",value:s,rows:1,onChange:d})]})},I=e=>{let{conversation:t,models:r,apiKey:a,isUsingEnv:s,messageIsStreaming:n,modelError:i,messageError:d,loading:x,lightMode:u,onSend:p,onUpdateConversation:g,onAcceptEnv:h,stopConversationRef:f}=e,[v,b]=(0,o.useState)(),[w,k]=(0,o.useState)(!0),C=(0,o.useRef)(null),I=(0,o.useRef)(null),P=(0,o.useRef)(null),E=()=>{if(w){var e;null===(e=C.current)||void 0===e||e.scrollIntoView({behavior:"smooth"})}},T=()=>{if(I.current){let{scrollTop:e,scrollHeight:t,clientHeight:r}=I.current;e+r<t-30?k(!1):k(!0)}};return(0,o.useEffect)(()=>{var e;E(),null===(e=P.current)||void 0===e||e.focus()},[t.messages]),(0,o.useEffect)(()=>{let e=I.current;if(e)return e.addEventListener("scroll",T),()=>{e.removeEventListener("scroll",T)}},[]),(0,l.jsx)("div",{className:"relative flex-1 overflow-none dark:bg-[#343541] bg-white",children:a||s?i?(0,l.jsxs)("div",{className:"flex flex-col justify-center mx-auto h-full w-[300px] sm:w-[500px] space-y-6",children:[(0,l.jsx)("div",{className:"text-center text-red-500",children:"Error fetching models."}),(0,l.jsx)("div",{className:"text-center text-red-500",children:"Make sure your OpenAI API key is set in the bottom left of the sidebar or in a .env.local file and refresh."}),(0,l.jsx)("div",{className:"text-center text-red-500",children:"If you completed this step, OpenAI may be experiencing issues."})]}):(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)("div",{className:"overflow-scroll max-h-full",ref:I,children:0===t.messages.length?(0,l.jsx)(l.Fragment,{children:(0,l.jsxs)("div",{className:"flex flex-col mx-auto pt-12 space-y-10 w-[350px] sm:w-[600px]",children:[(0,l.jsx)("div",{className:"text-4xl font-semibold text-center text-gray-800 dark:text-gray-100",children:0===r.length?"Loading...":"Chatbot UI"}),r.length>0&&(0,l.jsxs)("div",{className:"flex flex-col h-full space-y-4 border p-4 rounded border-neutral-500",children:[(0,l.jsx)(y,{model:t.model,models:r,onModelChange:e=>g(t,{key:"model",value:e})}),(0,l.jsx)(S,{conversation:t,onChangePrompt:e=>g(t,{key:"prompt",value:e})})]})]})}):(0,l.jsxs)(l.Fragment,{children:[(0,l.jsxs)("div",{className:"flex justify-center py-2 text-neutral-500 bg-neutral-100 dark:bg-[#444654] dark:text-neutral-200 text-sm border border-b-neutral-300 dark:border-none",children:["Model: ",t.model.name]}),t.messages.map((e,t)=>(0,l.jsx)(j,{message:e,lightMode:u},t)),x&&(0,l.jsx)(m,{}),(0,l.jsx)("div",{className:"bg-white dark:bg-[#343541] h-[162px]",ref:C})]})}),d?(0,l.jsx)(N,{onRegenerate:()=>{v&&p(v,!0)}}):(0,l.jsx)(c,{stopConversationRef:f,textareaRef:P,messageIsStreaming:n,onSend:e=>{b(e),p(e,!1)},model:t.model})]}):(0,l.jsxs)("div",{className:"flex flex-col justify-center mx-auto h-full w-[300px] sm:w-[500px] space-y-6",children:[(0,l.jsx)("div",{className:"text-2xl font-semibold text-center text-gray-800 dark:text-gray-100",children:"OpenAI API Key Required"}),(0,l.jsx)("div",{className:"text-center text-gray-500 dark:text-gray-400",children:"Please set your OpenAI API key in the bottom left of the sidebar."}),(0,l.jsx)("div",{className:"text-center text-gray-500 dark:text-gray-400",children:"- OR -"}),(0,l.jsx)("button",{className:"flex items-center justify-center mx-auto px-4 py-2 border border-transparent text-xs rounded-md text-white bg-gray-600 hover:bg-gray-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-gray-500",onClick:()=>h(!0),children:"click if using a .env.local file"})]})})};var P=r(1177);let E=e=>{let{selectedConversation:t,onNewConversation:r}=e;return(0,l.jsxs)("nav",{className:"flex justify-between bg-[#202123] py-3 px-4 w-full",children:[(0,l.jsx)("div",{className:"mr-4"}),(0,l.jsx)("div",{className:"max-w-[240px] whitespace-nowrap overflow-hidden text-ellipsis",children:t.name}),(0,l.jsx)(P.Z,{className:"cursor-pointer hover:text-neutral-400",onClick:r})]})};var T=r(16745),_=r(89014),Z=r(47447),z=r(88198),O=r(97283),D=r(30471),U=r(74075);let A=e=>{let{selectedConversation:t,conversation:r,loading:a,onSelectConversation:s,onDeleteConversation:n,onUpdateConversation:i}=e,[d,c]=(0,o.useState)(!1),[x,m]=(0,o.useState)(!1),[u,p]=(0,o.useState)(""),g=e=>{"Enter"===e.key&&(e.preventDefault(),f(t))},h=(e,t)=>{e.dataTransfer&&e.dataTransfer.setData("conversation",JSON.stringify(t))},f=e=>{i(e,{key:"name",value:u}),p(""),m(!1)};return(0,o.useEffect)(()=>{x?c(!1):d&&m(!1)},[x,d]),(0,l.jsxs)("button",{className:"flex w-full gap-3 items-center p-3 text-sm rounded-lg hover:bg-[#343541]/90 transition-colors duration-200 cursor-pointer ".concat(a?"disabled:cursor-not-allowed":""," ").concat(t.id===r.id?"bg-[#343541]/90":""),onClick:()=>s(r),disabled:a,draggable:"true",onDragStart:e=>h(e,r),children:[(0,l.jsx)(Z.Z,{size:16}),x&&t.id===r.id?(0,l.jsx)("input",{className:"flex-1 bg-transparent border-b border-neutral-400 focus:border-neutral-100 text-left overflow-hidden overflow-ellipsis pr-1 outline-none text-white",type:"text",value:u,onChange:e=>p(e.target.value),onKeyDown:g,autoFocus:!0}):(0,l.jsx)("div",{className:"overflow-hidden whitespace-nowrap overflow-ellipsis pr-1 flex-1 text-left",children:r.name}),(d||x)&&t.id===r.id&&(0,l.jsxs)("div",{className:"flex gap-1 -ml-2",children:[(0,l.jsx)(z.Z,{className:"min-w-[20px] text-neutral-400 hover:text-neutral-100",size:16,onClick:e=>{e.stopPropagation(),d?n(r):x&&f(r),c(!1),m(!1)}}),(0,l.jsx)(O.Z,{className:"min-w-[20px] text-neutral-400 hover:text-neutral-100",size:16,onClick:e=>{e.stopPropagation(),c(!1),m(!1)}})]}),t.id===r.id&&!d&&!x&&(0,l.jsxs)("div",{className:"flex gap-1 -ml-2",children:[(0,l.jsx)(D.Z,{className:"min-w-[20px] text-neutral-400 hover:text-neutral-100",size:18,onClick:e=>{e.stopPropagation(),m(!0),p(t.name)}}),(0,l.jsx)(U.Z,{className:" min-w-[20px] text-neutral-400 hover:text-neutral-100",size:18,onClick:e=>{e.stopPropagation(),c(!0)}})]})]})},R=e=>{let{loading:t,conversations:r,selectedConversation:a,onSelectConversation:s,onDeleteConversation:o,onUpdateConversation:n}=e;return(0,l.jsx)("div",{className:"flex flex-col-reverse gap-1 w-full pt-2",children:r.map((e,r)=>(0,l.jsx)(A,{selectedConversation:a,conversation:e,loading:t,onSelectConversation:s,onDeleteConversation:o,onUpdateConversation:n},r))})};var L=r(87664),F=r(62577);let G=e=>{let{searchTerm:t,conversations:r,currentFolder:a,onDeleteFolder:s,onUpdateFolder:n,selectedConversation:i,loading:d,onSelectConversation:c,onDeleteConversation:x,onUpdateConversation:m}=e,[u,p]=(0,o.useState)(!1),[g,h]=(0,o.useState)(!1),[f,v]=(0,o.useState)(""),[b,w]=(0,o.useState)(!1),j=e=>{"Enter"===e.key&&(e.preventDefault(),y())},y=()=>{n(a.id,f),v(""),h(!1)},k=(e,t)=>{if(e.dataTransfer){w(!0);let r=JSON.parse(e.dataTransfer.getData("conversation"));m(r,{key:"folderId",value:t.id}),e.target.style.background="none"}},N=e=>{e.preventDefault()},C=e=>{e.target.style.background="#343541"},S=e=>{e.target.style.background="none"};return(0,o.useEffect)(()=>{g?p(!1):u&&h(!1)},[g,u]),(0,o.useEffect)(()=>{t?w(!0):w(!1)},[t]),(0,l.jsxs)("div",{children:[(0,l.jsxs)("div",{className:"mb-1 flex gap-3 items-center px-3 py-2 text-sm rounded-lg hover:bg-[#343541]/90 transition-colors duration-200 cursor-pointer",onClick:()=>w(!b),onDrop:e=>k(e,a),onDragOver:N,onDragEnter:C,onDragLeave:S,children:[b?(0,l.jsx)(L.Z,{size:16}):(0,l.jsx)(F.Z,{size:16}),g?(0,l.jsx)("input",{className:"flex-1 bg-transparent border-b border-neutral-400 focus:border-neutral-100 text-left overflow-hidden overflow-ellipsis pr-1 outline-none text-white",type:"text",value:f,onChange:e=>v(e.target.value),onKeyDown:j,autoFocus:!0}):(0,l.jsx)("div",{className:"overflow-hidden whitespace-nowrap overflow-ellipsis pr-1 flex-1 text-left",children:a.name}),(u||g)&&(0,l.jsxs)("div",{className:"flex gap-1 -ml-2",children:[(0,l.jsx)(z.Z,{className:"min-w-[20px] text-neutral-400 hover:text-neutral-100",size:16,onClick:e=>{e.stopPropagation(),u?s(a.id):g&&y(),p(!1),h(!1)}}),(0,l.jsx)(O.Z,{className:"min-w-[20px] text-neutral-400 hover:text-neutral-100",size:16,onClick:e=>{e.stopPropagation(),p(!1),h(!1)}})]}),!u&&!g&&(0,l.jsxs)("div",{className:"flex gap-1 ml-2",children:[(0,l.jsx)(D.Z,{className:"min-w-[20px] text-neutral-400 hover:text-neutral-100",size:18,onClick:e=>{e.stopPropagation(),h(!0),v(a.name)}}),(0,l.jsx)(U.Z,{className:" min-w-[20px] text-neutral-400 hover:text-neutral-100",size:18,onClick:e=>{e.stopPropagation(),p(!0)}})]})]}),b?r.map((e,t)=>{if(e.folderId===a.id)return(0,l.jsx)("div",{className:"ml-5 pl-2 border-l gap-2 pt-2",children:(0,l.jsx)(A,{selectedConversation:i,conversation:e,loading:d,onSelectConversation:c,onDeleteConversation:x,onUpdateConversation:m})},t)}):null]})},J=e=>{let{searchTerm:t,conversations:r,folders:a,onDeleteFolder:s,onUpdateFolder:o,selectedConversation:n,loading:i,onSelectConversation:d,onDeleteConversation:c,onUpdateConversation:x}=e;return(0,l.jsx)("div",{className:"flex flex-col gap-1 w-full pt-2",children:a.map((e,a)=>(0,l.jsx)(G,{searchTerm:t,conversations:r.filter(e=>e.folderId),currentFolder:e,onDeleteFolder:s,onUpdateFolder:o,selectedConversation:n,loading:i,onSelectConversation:d,onDeleteConversation:c,onUpdateConversation:x},a))})},M=e=>{let{searchTerm:t,onSearch:r}=e,a=e=>{r(e.target.value)},s=()=>{r("")};return(0,l.jsxs)("div",{className:"relative flex items-center",children:[(0,l.jsx)("input",{className:"flex-1 w-full pr-10 bg-[#202123] border border-neutral-600 text-sm rounded-md px-4 py-3 text-white",type:"text",placeholder:"Search conversations...",value:t,onChange:a}),t&&(0,l.jsx)(O.Z,{className:"absolute right-4 text-neutral-300 cursor-pointer hover:text-neutral-400",size:24,onClick:s})]})};var K=r(75846),H=r(51047),B=r(64738);let W=e=>{let{text:t,icon:r,onClick:a}=e;return(0,l.jsxs)("div",{className:"flex py-3 px-3 gap-3 rounded-md hover:bg-gray-500/10 transition-colors duration-200 text-white cursor-pointer w-full items-center",onClick:a,children:[(0,l.jsx)("div",{children:r}),(0,l.jsx)("div",{children:t})]})},Y=e=>{let{onClearConversations:t}=e,[r,a]=(0,o.useState)(!1),s=()=>{t(),a(!1)};return r?(0,l.jsxs)("div",{className:"flex hover:bg-[#343541] py-3 px-3 rounded-md cursor-pointer w-full items-center",children:[(0,l.jsx)(U.Z,{size:16}),(0,l.jsx)("div",{className:"ml-3 flex-1 text-left text-white",children:"Are you sure?"}),(0,l.jsxs)("div",{className:"flex w-[40px]",children:[(0,l.jsx)(z.Z,{className:"ml-auto min-w-[20px] text-neutral-400 hover:text-neutral-100",size:18,onClick:e=>{e.stopPropagation(),s()}}),(0,l.jsx)(O.Z,{className:"ml-auto min-w-[20px] text-neutral-400 hover:text-neutral-100",size:18,onClick:e=>{e.stopPropagation(),a(!1)}})]})]}):(0,l.jsx)(W,{text:"Clear conversations",icon:(0,l.jsx)(U.Z,{size:16}),onClick:()=>a(!0)})},q=e=>{let t=e;return t.model||(t={...t,model:t.model||n[s.GPT_3_5]}),t.prompt||(t={...t,prompt:t.prompt||C}),t.folderId||(t={...t,folderId:t.folderId||0}),t},X=e=>{let t=[...e];return t.forEach(e=>{e.model||(e.model=n[s.GPT_3_5]),e.prompt||(e.prompt=C),e.folderId||(e.folderId=0)}),t};var V=r(52216);let Q=e=>{let{onImport:t}=e;return(0,l.jsxs)("div",{className:"flex py-3 px-3 gap-3 rounded-md hover:bg-gray-500/10 transition-colors duration-200 text-white cursor-pointer w-full items-center",children:[(0,l.jsx)("input",{className:"opacity-0 absolute w-[200px] cursor-pointer",type:"file",accept:".json",onChange:e=>{var r;if(!(null===(r=e.target.files)||void 0===r?void 0:r.length))return;let a=e.target.files[0],s=new FileReader;s.onload=e=>{var r;let a=JSON.parse(null===(r=e.target)||void 0===r?void 0:r.result);a.folders||(a={history:X(a),folders:[]}),t({conversations:a.history,folders:a.folders})},s.readAsText(a)}}),(0,l.jsxs)("div",{className:"flex items-center gap-3 text-left",children:[(0,l.jsx)(V.Z,{size:16}),(0,l.jsx)("div",{children:"Import conversations"})]})]})};var $=r(35336);let ee=e=>{let{apiKey:t,onApiKeyChange:r}=e,[a,s]=(0,o.useState)(!1),[n,i]=(0,o.useState)(t),d=e=>{"Enter"===e.key&&(e.preventDefault(),c(n))},c=e=>{r(e.trim()),s(!1)};return a?(0,l.jsxs)("div",{className:"flex transition-colors duration:200 hover:bg-gray-500/10 py-3 px-3 rounded-md cursor-pointer w-full items-center",children:[(0,l.jsx)($.Z,{size:16}),(0,l.jsx)("input",{className:"ml-2 flex-1 h-[20px] bg-transparent border-b border-neutral-400 focus:border-neutral-100 text-left overflow-hidden overflow-ellipsis pr-1 outline-none text-white",type:"password",value:n,onChange:e=>i(e.target.value),onKeyDown:d}),(0,l.jsxs)("div",{className:"flex w-[40px]",children:[(0,l.jsx)(z.Z,{className:"ml-auto min-w-[20px] text-neutral-400 hover:text-neutral-100",size:18,onClick:e=>{e.stopPropagation(),c(n)}}),(0,l.jsx)(O.Z,{className:"ml-auto min-w-[20px] text-neutral-400 hover:text-neutral-100",size:18,onClick:e=>{e.stopPropagation(),s(!1),i(t)}})]})]}):(0,l.jsx)(W,{text:"OpenAI API Key",icon:(0,l.jsx)($.Z,{size:16}),onClick:()=>s(!0)})},et=e=>{let{baseUrl:t,onBaseUrlChange:r}=e,[a,s]=(0,o.useState)(!1),[n,i]=(0,o.useState)(t),d=e=>{"Enter"===e.key&&(e.preventDefault(),c(n))},c=e=>{r(e.trim()),s(!1)};return a?(0,l.jsxs)("div",{className:"flex transition-colors duration:200 hover:bg-gray-500/10 py-3 px-3 rounded-md cursor-pointer w-full items-center",children:[(0,l.jsx)($.Z,{size:16}),(0,l.jsx)("input",{className:"ml-2 flex-1 h-[20px] bg-transparent border-b border-neutral-400 focus:border-neutral-100 text-left overflow-hidden overflow-ellipsis pr-1 outline-none text-white",type:"password",value:n,onChange:e=>i(e.target.value),onKeyDown:d}),(0,l.jsxs)("div",{className:"flex w-[40px]",children:[(0,l.jsx)(z.Z,{className:"ml-auto min-w-[20px] text-neutral-400 hover:text-neutral-100",size:18,onClick:e=>{e.stopPropagation(),c(n)}}),(0,l.jsx)(O.Z,{className:"ml-auto min-w-[20px] text-neutral-400 hover:text-neutral-100",size:18,onClick:e=>{e.stopPropagation(),s(!1),i(t)}})]})]}):(0,l.jsx)(W,{text:"Api Base Url",icon:(0,l.jsx)($.Z,{size:16}),onClick:()=>s(!0)})},er=e=>{let{lightMode:t,apiKey:r,baseUrl:a,onToggleLightMode:s,onApiKeyChange:o,onBaseUrlChange:n,onClearConversations:i,onExportConversations:d,onImportConversations:c}=e;return(0,l.jsxs)("div",{className:"flex flex-col pt-1 items-center border-t border-white/20 text-sm space-y-1",children:[(0,l.jsx)(Y,{onClearConversations:i}),(0,l.jsx)(Q,{onImport:c}),(0,l.jsx)(W,{text:"Export conversations",icon:(0,l.jsx)(K.Z,{size:16}),onClick:()=>d()}),(0,l.jsx)(W,{text:"light"===t?"Dark mode":"Light mode",icon:"light"===t?(0,l.jsx)(H.Z,{size:16}):(0,l.jsx)(B.Z,{size:16}),onClick:()=>s("light"===t?"dark":"light")}),(0,l.jsx)(et,{baseUrl:a,onBaseUrlChange:n}),(0,l.jsx)(ee,{apiKey:r,onApiKeyChange:o})]})},ea=e=>{let{loading:t,conversations:r,lightMode:a,selectedConversation:s,apiKey:n,baseUrl:i,folders:d,onCreateFolder:c,onDeleteFolder:x,onUpdateFolder:m,onNewConversation:u,onToggleLightMode:p,onSelectConversation:g,onDeleteConversation:h,onToggleSidebar:f,onUpdateConversation:v,onApiKeyChange:b,onBaseUrlChange:w,onClearConversations:j,onExportConversations:y,onImportConversations:k}=e,[N,C]=(0,o.useState)(""),[S,I]=(0,o.useState)(r),E=(e,t)=>{v(e,t),C("")},Z=e=>{h(e),C("")},z=e=>{if(e.dataTransfer){let t=JSON.parse(e.dataTransfer.getData("conversation"));v(t,{key:"folderId",value:0}),e.target.style.background="none"}},O=e=>{e.preventDefault()},D=e=>{e.target.style.background="#343541"},U=e=>{e.target.style.background="none"};return(0,o.useEffect)(()=>{N?I(r.filter(e=>{let t=e.name.toLocaleLowerCase()+" "+e.messages.map(e=>e.content).join(" ");return t.toLowerCase().includes(N.toLowerCase())})):I(r)},[N,r]),(0,l.jsxs)("aside",{className:"h-full flex flex-none space-y-2 p-2 flex-col bg-[#202123] w-[260px] z-10 sm:relative sm:top-0 absolute top-12 bottom-0",children:[(0,l.jsxs)("header",{className:"flex items-center",children:[(0,l.jsxs)("button",{className:"flex gap-3 p-3 items-center w-[190px] rounded-md hover:bg-gray-500/10 transition-colors duration-200 text-white cursor-pointer text-sm flex-shrink-0 border border-white/20",onClick:()=>{u(),C("")},children:[(0,l.jsx)(P.Z,{size:16}),"New chat"]}),(0,l.jsx)("button",{className:"ml-2 flex gap-3 p-3 items-center rounded-md hover:bg-gray-500/10 transition-colors duration-200 text-white cursor-pointer text-sm flex-shrink-0 border border-white/20",onClick:()=>c("New folder"),children:(0,l.jsx)(T.Z,{size:16})}),(0,l.jsx)(_.Z,{className:"ml-1 p-1 text-neutral-300 cursor-pointer hover:text-neutral-400 hidden sm:flex",size:32,onClick:f})]}),r.length>1&&(0,l.jsx)(M,{searchTerm:N,onSearch:C}),(0,l.jsxs)("div",{className:"flex-grow overflow-auto",children:[d.length>0&&(0,l.jsx)("div",{className:"flex border-b border-white/20 pb-2",children:(0,l.jsx)(J,{searchTerm:N,conversations:S.filter(e=>0!==e.folderId),folders:d,onDeleteFolder:x,onUpdateFolder:m,selectedConversation:s,loading:t,onSelectConversation:g,onDeleteConversation:Z,onUpdateConversation:E})}),r.length>0?(0,l.jsx)("div",{className:"pt-2 h-full",onDrop:e=>z(e),onDragOver:O,onDragEnter:D,onDragLeave:U,children:(0,l.jsx)(R,{loading:t,conversations:S.filter(e=>0===e.folderId),selectedConversation:s,onSelectConversation:g,onDeleteConversation:Z,onUpdateConversation:E})}):(0,l.jsx)("div",{className:"mt-4 text-white text-center",children:(0,l.jsx)("div",{children:"No conversations."})})]}),(0,l.jsx)(er,{lightMode:a,apiKey:n,baseUrl:i,onToggleLightMode:p,onApiKeyChange:b,onBaseUrlChange:w,onClearConversations:j,onExportConversations:y,onImportConversations:k})]})},es=(e,t)=>{let r=t.map(t=>t.id===e.id?e:t);return el(e),eo(r),{single:e,all:r}},el=e=>{localStorage.setItem("selectedConversation",JSON.stringify(e))},eo=e=>{localStorage.setItem("conversationHistory",JSON.stringify(e))},en=e=>{localStorage.setItem("folders",JSON.stringify(e))},ei=()=>{let e=localStorage.getItem("conversationHistory"),t=localStorage.getItem("folders");e&&(e=JSON.parse(e)),t&&(t=JSON.parse(t));let r={history:e,folders:t},a=new Blob([JSON.stringify(r)],{type:"application/json"}),s=URL.createObjectURL(a),l=document.createElement("a");l.download="chatbot_ui_history.json",l.href=s,l.style.display="none",document.body.appendChild(l),l.click(),document.body.removeChild(l),URL.revokeObjectURL(s)},ed=(e,t)=>{localStorage.setItem("conversationHistory",JSON.stringify(e)),localStorage.setItem("selectedConversation",JSON.stringify(e[e.length-1])),localStorage.setItem("folders",JSON.stringify(t))};var ec=r(98963),ex=r(9008),em=r.n(ex);function eu(){let[e,t]=(0,o.useState)([]),[r,a]=(0,o.useState)([]),[i,d]=(0,o.useState)(),[c,x]=(0,o.useState)(!1),[m,u]=(0,o.useState)([]),[p,g]=(0,o.useState)("dark"),[h,f]=(0,o.useState)(!1),[v,b]=(0,o.useState)(!0),[w,j]=(0,o.useState)(""),[y,k]=(0,o.useState)(""),[N,S]=(0,o.useState)(!1),[P,T]=(0,o.useState)(!1),[Z,z]=(0,o.useState)(!1),O=(0,o.useRef)(!1),D=async(e,t)=>{if(i){let s;if(t){let t=[...i.messages];t.pop(),s={...i,messages:[...t,e]}}else s={...i,messages:[...i.messages,e]};d(s),x(!0),f(!0),S(!1);let l={model:s.model,messages:s.messages,key:w,baseUrl:y,prompt:s.prompt},o=new AbortController,n=await fetch("/chatbot/api/chat",{method:"POST",headers:{"Content-Type":"application/json"},signal:o.signal,body:JSON.stringify(l)});if(!n.ok){x(!1),f(!1),S(!0);return}let c=n.body;if(!c){x(!1),f(!1),S(!0);return}if(1===s.messages.length){let{content:t}=e,r=t.length>30?t.substring(0,30)+"...":t;s={...s,name:r}}x(!1);let m=c.getReader(),u=new TextDecoder,p=!1,g=!0,h="";for(;!p;){if(!0===O.current){o.abort(),p=!0;break}let{value:e,done:t}=await m.read();p=t;let r=u.decode(e);if(h+=r,g){g=!1;let e=[...s.messages,{role:"assistant",content:r}];d(s={...s,messages:e})}else{let e=s.messages.map((e,t)=>t===s.messages.length-1?{...e,content:h}:e);d(s={...s,messages:e})}}el(s);let v=r.map(e=>e.id===i.id?s:e);0===v.length&&v.push(s),a(v),eo(v),f(!1)}},U=async(e,t)=>{let r=await fetch("/chatbot/api/models",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({key:e,baseUrl:t})});if(!r.ok){T(!0);return}let a=await r.json();if(!a){T(!0);return}u(a),T(!1)},A=e=>{g(e),localStorage.setItem("theme",e)},R=e=>{j(e),localStorage.setItem("apiKey",e)},L=e=>{k(e),localStorage.setItem("apiBaseUrl",e)},F=e=>{z(e),localStorage.setItem("isUsingEnv",e.toString())},G=()=>{ei()},J=e=>{ed(e.conversations,e.folders),a(e.conversations),d(e.conversations[e.conversations.length-1]),t(e.folders)},M=e=>{d(e),el(e)},K=r=>{let a=e[e.length-1],s={id:a?a.id+1:1,name:r},l=[...e,s];t(l),en(l)},H=s=>{let l=e.filter(e=>e.id!==s);t(l),en(l);let o=r.map(e=>e.folderId===s?{...e,folderId:0}:e);a(o),eo(o)},B=(r,a)=>{let s=e.map(e=>e.id===r?{...e,name:a}:e);t(s),en(s)},W=()=>{let e=r[r.length-1],t={id:e?e.id+1:1,name:"Conversation ".concat(e?e.id+1:1),messages:[],model:n[s.GPT_3_5],prompt:C,folderId:0},l=[...r,t];d(t),a(l),el(t),eo(l),x(!1)},Y=e=>{let t=r.filter(t=>t.id!==e.id);a(t),eo(t),t.length>0?(d(t[t.length-1]),el(t[t.length-1])):(d({id:1,name:"New conversation",messages:[],model:n[s.GPT_3_5],prompt:C,folderId:0}),localStorage.removeItem("selectedConversation"))},V=(e,t)=>{let s={...e,[t.key]:t.value},{single:l,all:o}=es(s,r);d(l),a(o)},Q=()=>{a([]),localStorage.removeItem("conversationHistory"),d({id:1,name:"New conversation",messages:[],model:n[s.GPT_3_5],prompt:C,folderId:0}),localStorage.removeItem("selectedConversation"),t([]),localStorage.removeItem("folders"),z(!1),localStorage.removeItem("isUsingEnv")};return(0,o.useEffect)(()=>{window.innerWidth<640&&b(!1)},[i]),(0,o.useEffect)(()=>{let e=localStorage.getItem("theme");e&&g(e);let r=localStorage.getItem("apiKey")||"",l=localStorage.getItem("apiBaseUrl")||"";(r||l)&&(j(r),k(l),U(r,l));let o=localStorage.getItem("isUsingEnv");o&&(z("true"===o),U("",l)),window.innerWidth<640&&b(!1);let i=localStorage.getItem("folders");i&&t(JSON.parse(i));let c=localStorage.getItem("conversationHistory");if(c){let e=JSON.parse(c),t=X(e);a(t)}let x=localStorage.getItem("selectedConversation");if(x){let e=JSON.parse(x),t=q(e);d(t)}else d({id:1,name:"New conversation",messages:[],model:n[s.GPT_3_5],prompt:C,folderId:0})},[]),(0,o.useEffect)(()=>{(w||y)&&U(w,y)},[w,y]),(0,l.jsxs)(l.Fragment,{children:[(0,l.jsxs)(em(),{children:[(0,l.jsx)("title",{children:"Chatbot UI"}),(0,l.jsx)("meta",{name:"description",content:"ChatGPT but better."}),(0,l.jsx)("meta",{name:"viewport",content:"width=device-width, initial-scale=1"}),(0,l.jsx)("link",{rel:"icon",href:"/favicon.ico"})]}),i&&(0,l.jsxs)("main",{className:"flex flex-col h-screen w-screen text-white dark:text-white text-sm ".concat(p),children:[(0,l.jsx)("div",{className:"sm:hidden w-full fixed top-0",children:(0,l.jsx)(E,{selectedConversation:i,onNewConversation:W})}),(0,l.jsxs)("article",{className:"flex h-full w-full pt-[48px] sm:pt-0",children:[v?(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(ea,{loading:h,conversations:r,lightMode:p,selectedConversation:i,apiKey:w,baseUrl:y,folders:e,onToggleLightMode:A,onCreateFolder:K,onDeleteFolder:H,onUpdateFolder:B,onNewConversation:W,onSelectConversation:M,onDeleteConversation:Y,onToggleSidebar:()=>b(!v),onUpdateConversation:V,onApiKeyChange:R,onBaseUrlChange:L,onClearConversations:Q,onExportConversations:G,onImportConversations:J}),(0,l.jsx)(_.Z,{className:"fixed top-2.5 left-4 sm:top-1 sm:left-4 sm:text-neutral-700 dark:text-white cursor-pointer hover:text-gray-400 dark:hover:text-gray-300 h-7 w-7 sm:h-8 sm:w-8 sm:hidden",onClick:()=>b(!v)})]}):(0,l.jsx)(ec.Z,{className:"fixed text-white z-50 top-2.5 left-4 sm:top-1.5 sm:left-4 sm:text-neutral-700 dark:text-white cursor-pointer hover:text-gray-400 dark:hover:text-gray-300 h-7 w-7 sm:h-8 sm:w-8",onClick:()=>b(!v)}),(0,l.jsx)(I,{conversation:i,messageIsStreaming:h,apiKey:w,isUsingEnv:Z,modelError:P,messageError:N,models:m,loading:c,lightMode:p,onSend:D,onUpdateConversation:V,onAcceptEnv:F,stopConversationRef:O})]})]})]})}}},function(e){e.O(0,[622,774,888,179],function(){return e(e.s=48312)}),_N_E=e.O()}]);